<!DOCTYPE>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-gif-component/master/dist/aframe-gif-component.min.js"></script>

    <link rel="stylesheet" href="styles/styles.css">
    <script>
        AFRAME.registerComponent('detect-visible-component', { 
            schema: { 
                func: { default: "" } 
            }, 
            init: function () { 
                this.oldVisible = this.el.object3D.visible; 
            }, 
            tick: function () { 
                var newVisible = this.el.object3D.visible; 
                if (newVisible != this.oldVisible) { 
                    var func = this.data.func; 
                    var f = window[func]; 
                    if (f) {
                        f(this.el.object3D.visible); this.oldVisible = newVisible; 
                    } 
                } 
            }
        });
    </script>
</head>
<body style='margin : 0; overflow: hidden;'>
<a-scene embedded arjs="debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;" id="scene">
    <!-- Assets -->
    <a-assets id="assets">
        <img id="danilov" src="assets/danilov.png">
        <img id="lazchenko" src="assets/lazchenko.png">
        <img id="maleeva" src="assets/maleeva.png">
        <img id="necheukhin" src="assets/necheukhin.png">
        <img id="sretenskii" src="assets/sretenskii.png">

        <img id="belyakov" src="assets/belyakov.png">
        <img id="churakov" src="assets/churakov.png">
        <img id="kataev" src="assets/kataev.png">
        <img id="kuliapin" src="assets/kuliapin.png">
        <img id="moskalenko" src="assets/moskalenko.png">
        <img id="olisevich" src="assets/olisevich.png">
        <img id="orlov" src="assets/orlov.png">
        <img id="plotnikov" src="assets/plotnikov.png">
        <img id="polyakova" src="assets/polyakova.png">
        <img id="rizvanov" src="assets/rizvanov.png">
        <img id="kalikov" src="assets/kalikov.png">

        <a-asset-item id="arrow" src="https://raw.githubusercontent.com/mankoff/kdm-idl/master/KML/models/arrow.dae"></a-asset-item>

        <img id="nav4-img-1" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2Fmeeting2.gif">
        <img id="nav4-img-2" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2FVa11-anna-old-glitch(1)2.gif">
        <img id="nav45-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2FFood.png">
        <img id="nav47-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2Fcoffee%20beans.png">
        <img id="nav48-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2Fcoffee_fin.svg">
        <img id="nav49-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2FBooks.png">
        <img id="nav50-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2Flight%20switch.png">
        <img id="nav55-img" src="https://cdn.glitch.com/dcc03633-fec3-4dd6-a139-4a7f661aa681%2Fcups.png">

    </a-assets>

    <!-- ------- -->
    <!-- Markers -->
    <!-- ------- -->

    <!-- Meeting room -->
    <a-marker type='barcode' value='56'  detect-visible-component='func: step1'>
        <a-entity rotation="-90 0 0">
            <a-entity position="2 0 0" scale="4 4 1" text="value: Meeting Room #4"></a-entity>
            <a-entity position="-0.25 -0.2 0">
                <a-entity position="0 0 0" text="value: Thursday; wrapCount: 10; width: 0.5"></a-entity>
                <a-entity position="0 -0.12 0" text="value: 26; wrapCount: 6; width: 0.5"></a-entity>
            </a-entity>
            <a-entity position="0.5 -0.2 0">
                <a-entity position="0 0 0" text="value: 10:00am - 12:00pm"></a-entity>
                <a-entity position="0 -0.1 0" text="value: 12:00pm - 13:00pm"></a-entity>
                <a-entity position="0 -0.2 0" text="value: 13:00pm - 14:00pm"></a-entity>
                <a-entity position="0 -0.3 0" text="value: 14:00pm - 14:30pm"></a-entity>
                <a-entity position="0 -0.4 0" text="value: 14:30pm - 15:00pm"></a-entity>
            </a-entity>
            <a-entity position="0.95 -0.2 0">
                <a-entity position="0 0 0" text="value: All-hands Meeting: The Plans [Company Offsite]"></a-entity>
                <a-entity position="0 -0.1 0" text="value: Hackathon official opening"></a-entity>
                <a-entity position="0 -0.2 0" text="value: Rocket Team planning"></a-entity>
                <a-entity id="meeting-room-56-button" clickable="true" position="0 -0.3 0" text="zOffset: 0.051; value: [FREE]; color: #92CD00;"
                          geometry="primitive: box; height: 0.1; depth: 0.05" material="opacity: 0;"
                ></a-entity>
                <a-entity id="meeting-room-56-up-button" clickable="true" position="0 -0.4 0" text="zOffset: 0.051; value: [FREE]; color: #92CD00;" 
                          geometry="primitive: box; height: 0.1; depth: 0.05" material="opacity: 0;">
                </a-entity>
            </a-entity>
        </a-entity>
    </a-marker>

    <!-- People list in Features team -->
    <a-marker type='barcode' value='60'>
        <a-entity rotation="-90 0 0">
            <a-entity position="0 0.1 0" geometry="primitive: plane; width: 1; height: 0.8" material="shader: flat; color: #f6c038;"></a-entity>
            <a-entity position="-0.1 0 0" geometry="primitive: plane; width: 0.8; height: 1" material="shader: flat; color: #f6c038;"></a-entity>
            <a-entity position="0.3 -0.3 0" rotation="0 0 45" geometry="primitive: plane; width: 0.28284; height: 0.28284" material="shader: flat; color: #f6c038;"></a-entity>
            <a-entity text="value: Features team; align: center; width: 2;" position="0 0 0.1"></a-entity>

            <a-entity id="people-list" position="0 0.8 0.2">
            </a-entity>
        </a-entity>
    </a-marker>

    <!-- Some kitchen info -->
    <a-marker type='barcode' value='54'>
        <a-entity rotation="-90 0 0">
            <a-entity scale="0.3 1 1" position="1 -0.6 0" rotation="0 0 -120">
                <a-entity id="kitchen-arrow1">
                    <a-triangle color="#CCC"></a-triangle>
                    <a-entity text="value: Light switch; color: black; width: 2" rotation="0 0 90" position="0 0.6 0.1" scale="1 1.7 1"></a-entity>
                </a-entity>
            </a-entity>

            <a-entity scale="0.3 1 1" position="0.4 -1 0" rotation="0 0 -160">
                <a-entity id="kitchen-arrow2">
                    <a-triangle color="#CCC"></a-triangle>
                    <a-entity text="value: Food\nPrivate is private :)\n_; color: black; width: 2" rotation="0 0 90" position="0 0.6 0.1" scale="1 1.7 1"></a-entity>
                </a-entity>
            </a-entity>

            <a-entity scale="0.3 1 1" position="-0.3 -1.05 0" rotation="0 0 -190">
                <a-entity id="kitchen-arrow3">
                    <a-triangle color="#CCC"></a-triangle>
                    <a-entity text="value: Coffee beans; color: black; width: 2" rotation="0 0 90" position="0 0.6 0.1" scale="1 1.7 1"></a-entity>
                </a-entity>
            </a-entity>

            <a-entity scale="0.3 1 1" position="-0.9 -0.7 0" rotation="0 0 -230">
                <a-entity id="kitchen-arrow4">
                    <a-triangle color="#CCC"></a-triangle>
                    <a-entity text="value: Cups; color: black; width: 2" rotation="0 0 90" position="0 0.6 0.1" scale="1 1.7 1"></a-entity>
                </a-entity>
            </a-entity>
        </a-entity>
    </a-marker>

    <!-- Test devices -->
    <a-marker type='barcode' value='42' id="devicesMarker">
    </a-marker>

    <!-- Navigation -->
    <a-marker type="barcode" value="4">
        <a-entity position="0 0 0" rotation="-90 0 0">

            <a-entity position="0 0.5 0">
                <a-plane position="1 0 0" height="2" width="2" rotation="0 0 0" opacity="1" color="white" material="shader:gif;src:#nav4-img-2;" gif=""></a-plane>
            </a-entity>

            <a-entity position="0 -1 0">
                <a-plane position="0 0 0" height="1" width="4" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Meeting rooms" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
            </a-entity>

        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="5">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-entity position="0 0 0" rotation="0 0 135">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Exit" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 0">
                <a-plane position="0 3 0" height="1" width="5.5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Developers & Operations" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -45">
                <a-plane position="0 5 0" height="1" width="5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="People & Support" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -90">
                <a-plane position="0 3 0" height="1" width="4.5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Kitchen & Office 9" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="6">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-entity position="0 0 0" rotation="0 0 135">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Exit" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 90">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Office 8" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 0">
                <a-plane position="0 3 0" height="1" width="5.5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Canvas Team & Office 10" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -90">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Office 17" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -135">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Kitchen" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="7">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-entity position="0 0 0" rotation="0 0 180">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Exit" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 0">
                <a-plane position="0 3 0" height="1" width="2" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Office 9" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -45">
                <a-plane position="0 5 0" height="1" width="5.5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Developers & DevOps" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
            <a-entity position="0 0 0" rotation="0 0 -90">
                <a-plane position="0 3 0" height="1" width="5.5" rotation="0 0 0" opacity="0.5" color="#502175" visible="true">
                    <a-text value="Designers & Marketing" align="center" color="#E2D9E6" position="0 0 0.1" scale="2 2 2"></a-text>
                </a-plane>
                <a-collada-model src="#arrow" position="0 1 0" rotation="90 0 0">
                    <a-animation attribute="position" dur="1000" fill="forwards" to="0 10 0" repeat="indefinite" easing="ease-in-out"></a-animation>
                </a-collada-model>
            </a-entity>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="45">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav45-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="47">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav47-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="48">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav48-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="49">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav49-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="50">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav50-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

    <a-marker type="barcode" value="55">
        <a-entity position="0 0 0" rotation="-90 0 0">
            <a-plane position="2 0 0" height="1" width="1" rotation="0 0 0" opacity="1" visible="true" src="#nav55-img" scale="5 5 5"></a-plane>
        </a-entity>
    </a-marker>

   <!-- <a-marker preset='hiro'>
        <a-entity id="falcon-heavy" scale="0.25 0.25 0.25">
            <a-entity position="0 0.5 0" geometry="primitive: cylinder; height: 1; radius: 0.25" material="color: #f6c038;"></a-entity>
            <a-entity position="0.4 0 0" geometry="primitive: sphere; radius: 0.25" material="color: #f6c038;"></a-entity>
            <a-entity position="-0.4 0 0" geometry="primitive: sphere; radius: 0.25" material="color: #f6c038;"></a-entity>
            <a-entity position="0 1.25 0" geometry="primitive: sphere; radius: 0.25" material="color: #f6c038;"></a-entity>
        </a-entity>
    </a-marker>-->

    <!-- Camera -->
    <a-entity id="camera" camera></a-entity>
</a-scene>
<div class="calendar-back hidden">
    <div class="modal">
        <div class="input-group">
            <input class="eventNameInput" type="text" placeholder="Event name" />
        </div>
        <div class="btn-group">
            <button class="addEvent">Add</button><button class="cancelEvent">Cancel</button>
        </div>
    </div>
</div>
<div id="myDevices">
</div>
<script src="scripts/click.js"></script>
<script src="scripts/kitchen-info.js"></script>
<script src="scripts/people-list.js"></script>
<script src="scripts/person-info.js"></script>
<script src="scripts/meeting-room.js"></script>
<script src="scripts/test-devices.js"></script>
<script src="scripts/falcon-heavy.js"></script>
<script src="scripts/party-hard-oleg.js"></script>
<script>
	subscribeToClicks()
	renderPeopleListMarkup()
    registerTestDevices()
    activateMeetingRoom()
	injectPersonsInfo()
    animateKitchenInfo(['kitchen-arrow1', 'kitchen-arrow2', 'kitchen-arrow3', 'kitchen-arrow4'])
    launchRocket()
    letsDanceOleg()
</script>
</body>
